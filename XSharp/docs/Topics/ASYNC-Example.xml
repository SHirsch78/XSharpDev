<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="helpproject.xsl" ?>
<topic template="Default" status="Complete" lasteditedby="robert" version="2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="helpproject.xsd">
  <title>ASYNC Example</title>
  <body>
    <header>
      <para styleclass="Heading1">ASYNC Example</para>
    </header>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; font-style:italic; color:#008000; background-color:#ffffff;">//</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; font-style:italic; color:#008000; background-color:#ffffff;">// This example shows that you can call an async task and wait for it to finish</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; font-style:italic; color:#008000; background-color:#ffffff;">// The result of the async task (in this case the size of the file that has been downloaded)</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; font-style:italic; color:#008000; background-color:#ffffff;">// will be come available when the task has finished</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; font-style:italic; color:#008000; background-color:#ffffff;">// The calling code (The Start()) function will not have to wait until the async task has</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; font-style:italic; color:#008000; background-color:#ffffff;">// finished. That is why the line &quot;2.....&quot; will be printed before the results from TestClass.DoTest()</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; font-style:italic; color:#008000; background-color:#ffffff;">// The sample also shows an event and displays the thread id&apos;s. You can see that the DownloadFileTaskAsync() method</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; font-style:italic; color:#008000; background-color:#ffffff;">// starts multiple threads to download the web document in multiple pieces.</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">USING</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> System</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">USING</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> System</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">Threading</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">Tasks</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">FUNCTION</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> Start() </text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">AS</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">VOID</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> &#160; &#160;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">?</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#b22222; background-color:#ffffff;">&quot;1. calling long process&quot;</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> &#160; &#160;TestClass</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">DoTest()</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> &#160; &#160;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">?</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#b22222; background-color:#ffffff;">&quot;2. this should be printed while processing&quot;</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> &#160; &#160;Console</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">ReadKey()</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">CLASS</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> TestClass</text><tab /></para>
    <para styleclass="Normal"><tab /><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">STATIC</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">PROTECT</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> oLock </text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">AS</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">OBJECT</text><tab /><tab /><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; font-style:italic; color:#008000; background-color:#ffffff;">// To make sure we synchronize the writing to the screen</text></para>
    <para styleclass="Normal"><tab /><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">STATIC</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">CONSTRUCTOR</text></para>
    <para styleclass="Normal"><tab /><tab /><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">oLock </text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">:=</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">OBJECT</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">{}</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> &#160; &#160;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">ASYNC</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">STATIC</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">METHOD</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> DoTest() </text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">AS</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">VOID</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> &#160; &#160; &#160; &#160;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">LOCAL</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> Size </text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">AS</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">INT64</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> &#160; &#160; &#160; &#160;Size </text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">:=</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">AWAIT</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> LoooongProcess()</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> &#160; &#160; &#160; &#160;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">?</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#b22222; background-color:#ffffff;">&quot;3. returned from long process&quot;</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> &#160; &#160; &#160; &#160;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">?</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> Size</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">,</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#b22222; background-color:#ffffff;">&quot; Bytes downloaded&quot;</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> &#160; &#160;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">ASYNC</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">STATIC</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">METHOD</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> LoooongProcess() </text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">AS</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> Task</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">&lt;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">INT64</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">&gt;</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> &#160; &#160; &#160; &#160;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">VAR</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> WebClient </text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">:=</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> System</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">Net</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">WebClient{}</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> &#160; &#160; &#160; &#160;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">VAR</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> FileName </text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">:=</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> System</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">IO</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">Path</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">GetTempPath()</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">+</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#b22222; background-color:#ffffff;">&quot;temp.txt&quot;</text></para>
    <para styleclass="Normal"><tab /><tab /><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">webClient</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">:</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">DownloadProgressChanged </text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">+=</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> OnDownloadProgress</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> &#160; &#160; &#160; &#160;webClient</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">:</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">Credentials </text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">:=</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> System</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">Net</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">CredentialCache</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">DefaultNetworkCredentials</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> &#160; &#160; &#160; &#160;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">AWAIT</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> webClient</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">:</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">DownloadFileTaskAsync(</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#b22222; background-color:#ffffff;">&quot;http://www.xsharp.info/index.php&quot;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">,</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> FileName)</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> &#160; &#160; &#160; &#160;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">VAR</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> dirInfo &#160; &#160; &#160;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">:=</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> System</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">IO</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">DirectoryInfo{System</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">IO</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">Path</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">GetTempPath()}</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> &#160; &#160; &#160; &#160;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">VAR</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> Files &#160; &#160; &#160; &#160;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">:=</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> dirInfo</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">:</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">GetFiles(</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#b22222; background-color:#ffffff;">&quot;temp.txt&quot;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">)</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> &#160; &#160; &#160; &#160;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">IF</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> Files</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">:</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">Length </text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">&gt;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#b22222; background-color:#ffffff;">0</text></para>
    <para styleclass="Normal"><tab /><tab /><tab /><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">System</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">IO</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">File</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">Delete(FileName)</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> &#160; &#160; &#160; &#160; &#160; &#160;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">RETURN</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> Files[</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#b22222; background-color:#ffffff;">1</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">]</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">:</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">Length</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> &#160; &#160; &#160; &#160;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">ENDIF</text></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> &#160; &#160; &#160; &#160;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">RETURN</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#b22222; background-color:#ffffff;">0</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><tab /><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">STATIC</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">METHOD</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> OnDownloadProgress (sender </text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">AS</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">OBJECT</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">,</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> e </text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">AS</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> System</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">Net</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">DownloadProgressChangedEventArgs) </text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">AS</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">VOID</text></para>
    <para styleclass="Normal"><tab /><tab /><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">BEGIN</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">LOCK</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> oLock</text></para>
    <para styleclass="Normal"><tab /><tab /><tab /><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">?</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> String</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">Format(</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#b22222; background-color:#ffffff;">&quot;{0,3} % Size: {1,8:N0} Thread {2}&quot;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">,</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#b22222; background-color:#ffffff;">100</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">*</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">e</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">:</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">BytesReceived </text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">/</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> e</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">:</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">TotalBytesToReceive </text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">,</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> e</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">:</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">BytesReceived</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">, ;</text></para>
    <para styleclass="Normal"><tab /><tab /><tab /><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;"> &#160;System</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">Threading</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">Thread</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">.</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">CurrentThread</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#a9a9a9; background-color:#ffffff;">:</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">ManagedThreadId)</text></para>
    <para styleclass="Normal"><tab /><tab /><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">END</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">LOCK</text></para>
    <para styleclass="Normal"><tab /><tab /><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">RETURN</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">END</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#0000ff; background-color:#ffffff;">CLASS</text><text styleclass="" style="font-family:&apos;Courier New&apos;; font-size:12pt; font-weight:bold; color:#000000; background-color:#ffffff;">&#32;</text></para>
  </body>
</topic>
