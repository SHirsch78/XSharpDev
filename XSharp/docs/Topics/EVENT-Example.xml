<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="helpproject.xsl" ?>
<topic template="Default" status="Complete" lasteditedby="robert" version="2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="helpproject.xsd">
  <title>EVENT Example</title>
  <body>
    <header>
      <para styleclass="Heading1">EVENT Example</para>
    </header>
    <para styleclass="Code Example">USING System.Collections.Generic</para>
    <para styleclass="Code Example">FUNCTION Start AS VOID</para>
    <para styleclass="Code Example"> &#160; &#160;LOCAL e AS EventsExample</para>
    <para styleclass="Code Example"> &#160; &#160;e := EventsExample{}</para>
    <para styleclass="Code Example"> &#160; &#160;e:Event1 += TestClass.DelegateMethod</para>
    <para styleclass="Code Example"> &#160; &#160;e:Event1 += TestClass.DelegateMethod</para>
    <para styleclass="Code Example"> &#160; &#160;e:Event1 -= TestClass.DelegateMethod &#160; &#160;// added 2, removed 1, should be called once</para>
    <para styleclass="Code Example"> &#160; &#160;e:Event2 += TestClass.DelegateMethod</para>
    <para styleclass="Code Example"> &#160; &#160;e:Event2 += TestClass.DelegateMethod</para>
    <para styleclass="Code Example"> &#160; &#160;e:Event2 -= TestClass.DelegateMethod // added 2, removed 1, should be called once</para>
    <para styleclass="Code Example"> &#160; &#160;e:Event3 += TestClass.DelegateMethod</para>
    <para styleclass="Code Example"> &#160; &#160;e:RaiseEvent1(&quot;This is a test through a multi line event definition&quot;)</para>
    <para styleclass="Code Example"> &#160; &#160;e:RaiseEvent2(&quot;This is a test through a single line event definition&quot;)</para>
    <para styleclass="Code Example"> &#160; &#160;e:RaiseEvent3(&quot;This is a test through an old style event definition&quot;)</para>
    <para styleclass="Code Example"> &#160; &#160;Console.WriteLine(&quot;Press a Key&quot;)</para>
    <para styleclass="Code Example"> &#160; &#160;Console.ReadLine()</para>
    <para styleclass="Code Example"></para>
    <para styleclass="Code Example"></para>
    <para styleclass="Code Example"></para>
    <para styleclass="Code Example">DELEGATE EventHandler (s AS STRING) AS VOID</para>
    <para styleclass="Code Example"></para>
    <para styleclass="Code Example">CLASS TestClass</para>
    <para styleclass="Code Example"> &#160; &#160;STATIC METHOD DelegateMethod(s AS STRING ) AS VOID</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160;Console.WriteLine( s)</para>
    <para styleclass="Code Example">END CLASS</para>
    <para styleclass="Code Example"></para>
    <para styleclass="Code Example"></para>
    <para styleclass="Code Example">CLASS EventsExample</para>
    <para styleclass="Code Example"> &#160; &#160;PRIVATE eventsTable AS Dictionary&lt;STRING, System.Delegate&gt;</para>
    <para styleclass="Code Example"> &#160; &#160;PRIVATE CONST sEvent1 := &quot;Event1&quot; AS STRING</para>
    <para styleclass="Code Example"> &#160; &#160;PRIVATE CONST sEvent2 := &quot;Event2&quot; AS STRING</para>
    <para styleclass="Code Example"> &#160; &#160;CONSTRUCTOR()</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160;eventsTable := Dictionary&lt;STRING, System.Delegate&gt;{}</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160;eventsTable:Add(sEvent1,NULL_OBJECT)</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160;eventsTable:Add(sEvent2,NULL_OBJECT)</para>
    <para styleclass="Code Example"></para>
    <para styleclass="Code Example"> &#160; &#160;// Multiline definition</para>
    <para styleclass="Code Example"> &#160; &#160;EVENT Event1 AS EventHandler</para>
    <para styleclass="Code Example"></para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160;ADD</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160; &#160; &#160;BEGIN LOCK eventsTable</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;eventsTable[sEvent1] := ((EventHandler) eventsTable[sEvent1]) + value</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160; &#160; &#160;END LOCK</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160; &#160; &#160;Console.WriteLine(__ENTITY__ + &quot; &quot;+value:ToString())</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160;END</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160;REMOVE</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160; &#160; &#160;BEGIN LOCK eventsTable</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;eventsTable[sEvent1] := ((EventHandler) eventsTable[sEvent1]) - value</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160; &#160; &#160;END LOCK</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160; &#160; &#160;Console.WriteLine(__ENTITY__+ &quot; &quot;+value:ToString())</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160;END</para>
    <para styleclass="Code Example"> &#160; &#160;END EVENT</para>
    <para styleclass="Code Example"></para>
    <para styleclass="Code Example"></para>
    <para styleclass="Code Example"> &#160; &#160;// Single Line defintion on multilpe lines with semi colons, for better reading !</para>
    <para styleclass="Code Example"> &#160; &#160;EVENT Event2 AS EventHandler &#160;;</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160;ADD &#160; &#160; eventsTable[sEvent2] := ((EventHandler) eventsTable[sEvent2]) + value ;</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160;REMOVE &#160;eventsTable[sEvent2] := ((EventHandler) eventsTable[sEvent2]) - value</para>
    <para styleclass="Code Example"></para>
    <para styleclass="Code Example"> &#160; &#160;// Old style definition</para>
    <para styleclass="Code Example"> &#160; &#160;EVENT Event3 AS EventHandler</para>
    <para styleclass="Code Example"></para>
    <para styleclass="Code Example"> &#160; &#160;METHOD RaiseEvent1(s AS STRING) AS VOID</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160;VAR handler := (EventHandler) eventsTable[sEvent1]</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160;IF handler != NULL</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160; &#160; &#160;handler(s)</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160;ENDIF</para>
    <para styleclass="Code Example"></para>
    <para styleclass="Code Example"> &#160; &#160;METHOD RaiseEvent2(s AS STRING) AS VOID</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160;VAR handler := (EventHandler) eventsTable[sEvent2]</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160;IF handler != NULL</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160; &#160; &#160;handler(s)</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160;ENDIF</para>
    <para styleclass="Code Example"></para>
    <para styleclass="Code Example"> &#160; &#160;METHOD RaiseEvent3(s AS STRING) AS VOID</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160;IF SELF:Event3 != NULL</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160; &#160; &#160;Event3(s)</para>
    <para styleclass="Code Example"> &#160; &#160; &#160; &#160;ENDIF</para>
    <para styleclass="Code Example">END CLASS</para>
  </body>
</topic>
